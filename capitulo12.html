<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CapÃ­tulo 12 â€“ Storybook</title>
  <link rel="stylesheet" href="./css/general.css" />
  <link rel="stylesheet" href="./css/prism.css" />
</head>

<body>
  <div class="layout">
    <button id="menu-toggle" aria-label="Mostrar menÃº" class="menu-toggle">â˜°</button>
    <aside class="sidebar">
      <nav>
        <h2>Ãndice</h2>
        <ul>
          <li><a href="capitulo1.html">1. IntroducciÃ³n</a></li>
          <li><a href="capitulo2.html">2. InstalaciÃ³n y configuraciÃ³n</a></li>
          <li><a href="capitulo3.html">3. Estructura de un componente</a></li>
          <li><a href="capitulo4.html">4. Decoradores en profundidad</a></li>
          <li><a href="capitulo5.html">5. Ciclo de vida</a></li>
          <li><a href="capitulo6.html">6. Slots y Shadow DOM</a></li>
          <li><a href="capitulo7.html">7. ComunicaciÃ³n entre componentes</a></li>
          <li><a href="capitulo8.html">8. IntegraciÃ³n con APIs</a></li>
          <li><a href="capitulo9.html">9. Testing avanzado</a></li>
          <li><a href="capitulo10.html">10. OptimizaciÃ³n</a></li>
          <li><a href="capitulo11.html">11. LibrerÃ­as escalables</a></li>
          <li><a href="capitulo12.html">12. Storybook</a></li>
          <li><a href="capitulo13.html">13. PublicaciÃ³n</a></li>
          <li><a href="capitulo14.html">14. Buenas prÃ¡cticas</a></li>
          <li><a href="capitulo15.html">15. Proyecto final</a></li>
        </ul>
      </nav>
    </aside>

    <main class="content">
      <h1>CapÃ­tulo 12: Storybook</h1>

      <section>
        <h2>ğŸ“š Â¿QuÃ© es Storybook?</h2>
        <p>
          Storybook es una herramienta para desarrollar componentes de interfaz de usuario de forma aislada. Permite
          previsualizarlos, testearlos visualmente, documentarlos e interactuar con sus propiedades (props, eventos,
          slots, etc.) sin necesidad de ejecutar toda tu aplicaciÃ³n.
        </p>
      </section>

      <section>
        <h2>ğŸ¯ Beneficios de usar Storybook con Stencil</h2>
        <ul>
          <li>VisualizaciÃ³n aislada de cada componente</li>
          <li>DocumentaciÃ³n interactiva y viva</li>
          <li>ExploraciÃ³n de argumentos (props) con controles</li>
          <li>SimulaciÃ³n de eventos y pruebas manuales</li>
          <li>Facilidad para compartir y testear en equipo</li>
        </ul>
      </section>

      <section>
        <h2>âš™ï¸ InstalaciÃ³n avanzada</h2>
        <p>Ejecuta la instalaciÃ³n y el setup inicial:</p>
        <pre><code class="language-bash">
npx storybook@latest init
        </code></pre>
        <p>Selecciona <code class="inline-code">Web Components</code> como framework base.</p>

        <p>Instala tambiÃ©n los addons necesarios:</p>
        <pre><code class="language-bash">
npm install @storybook/addon-essentials @storybook/web-components-vite --save-dev
        </code></pre>
      </section>

      <section>
        <h2>ğŸ“ Estructura recomendada</h2>
        <pre><code class="language-bash">
.storybook/
â”œâ”€â”€ main.js          # ConfiguraciÃ³n base
â”œâ”€â”€ preview.js       # ConfiguraciÃ³n global (estilos, decoradores...)
stories/
â”œâ”€â”€ mi-boton.stories.ts
â”œâ”€â”€ tarjeta-user.stories.ts
        </code></pre>
      </section>

      <section>
        <h2>ğŸ”§ ConfiguraciÃ³n de <code class="inline-code">main.js</code></h2>
        <pre><code class="language-js">
<span class="keyword">module.exports</span> = {
  stories: [<span class="string">'../stories/**/*.stories.ts'</span>],
  addons: [
    <span class="string">'@storybook/addon-essentials'</span>,
  ],
  framework: {
    name: <span class="string">'@storybook/web-components-vite'</span>,
    options: {}
  }
};
        </code></pre>
      </section>

      <section>
        <h2>ğŸ§± Estructura de una historia</h2>
        <p>Ejemplo bÃ¡sico:</p>
        <pre><code class="language-ts">
// stories/mi-boton.stories.ts

<span class="keyword">export default</span> {
  title: <span class="string">'Componentes/MiBoton'</span>,
  tags: [<span class="string">'autodocs'</span>],
  argTypes: {
    texto: { control: 'text' },
    color: { control: 'select', options: ['primario', 'secundario'] },
    deshabilitado: { control: 'boolean' },
  }
};

<span class="keyword">const</span> <span class="function">Template</span> = (args) => {
  <span class="keyword">return</span> <span class="string">`&lt;mi-boton texto="${args.texto}" color="${args.color}" ?deshabilitado="${args.deshabilitado}"&gt;&lt;/mi-boton&gt;`</span>;
};

<span class="keyword">export const</span> <span class="function">PorDefecto</span> = Template.bind({});
PorDefecto.args = {
  texto: <span class="string">'Aceptar'</span>,
  color: <span class="string">'primario'</span>,
  deshabilitado: <span class="keyword">false</span>,
};
        </code></pre>
      </section>

      <section>
        <h2>ğŸ›ï¸ ArgTypes y controles interactivos</h2>
        <p>Define en <code class="inline-code">argTypes</code> cÃ³mo se renderiza cada control en la interfaz:</p>
        <ul>
          <li><strong>text</strong>: cadenas de texto</li>
          <li><strong>boolean</strong>: checkbox</li>
          <li><strong>select</strong>: menÃº desplegable</li>
          <li><strong>color</strong>: selector de color</li>
        </ul>
      </section>

      <section>
        <h2>ğŸ¨ Aplicar estilos globales</h2>
        <p>En <code class="inline-code">.storybook/preview.js</code> puedes importar CSS general:</p>
        <pre><code class="language-js">
import '../src/global/estilos.css';
        </code></pre>
        <p>TambiÃ©n puedes usar <code class="inline-code">decorators</code> para envolver todos los componentes:</p>
        <pre><code class="language-js">
<span class="keyword">export const</span> decorators = [
  (story) => <span class="string">`&lt;div style="padding: 2em;"&gt;${story()}&lt;/div&gt;`</span>,
];
        </code></pre>
      </section>

      <section>
        <h2>ğŸ§ª Escuchar eventos personalizados</h2>
        <p>Puedes capturar eventos con <code class="inline-code">action()</code>:</p>
        <pre><code class="language-ts">
import { action } from '@storybook/addon-actions';

<span class="keyword">const</span> Template = () => {
  <span class="keyword">const</span> boton = document.createElement('mi-boton');
  boton.addEventListener('click', action('click personalizado'));
  <span class="keyword">return</span> boton;
};
        </code></pre>
      </section>

      <section>
        <h2>ğŸ§© Addons recomendados</h2>
        <ul>
          <li><strong>@storybook/addon-a11y</strong>: validaciÃ³n de accesibilidad</li>
          <li><strong>@storybook/addon-actions</strong>: visualizar eventos</li>
          <li><strong>@storybook/addon-controls</strong>: controles de props</li>
          <li><strong>@storybook/addon-docs</strong>: documentaciÃ³n automÃ¡tica</li>
        </ul>
      </section>

      <section>
        <h2>ğŸ“¦ IntegraciÃ³n con Stencil.js</h2>
        <p>Importa los componentes dentro de Storybook:</p>
        <pre><code class="language-ts">
import { defineCustomElements } from '../dist/loader';
defineCustomElements();
        </code></pre>
        <p>AsegÃºrate de que la build de Stencil estÃ© generada con <code class="inline-code">npm run build</code>.</p>
      </section>

      <section>
        <h2>ğŸ”¬ Historias con slots y contenido dinÃ¡mico</h2>
        <p>Puedes inyectar contenido dentro de slots:</p>
        <pre><code class="language-ts">
<span class="keyword">const</span> SlotTemplate = () => {
  <span class="keyword">return</span> <span class="string">`
    &lt;tarjeta-user nombre="LucÃ­a"&gt;
      &lt;span slot="footer"&gt;Pie de tarjeta&lt;/span&gt;
    &lt;/tarjeta-user&gt;
  `</span>;
};
        </code></pre>
      </section>

      <section>
        <h2>ğŸ“¦ Integrar Storybook y Stencil en el mismo repositorio</h2>
        <p>
          Puedes mantener tanto Stencil como Storybook en el mismo repositorio sin problema. Lo mÃ¡s habitual es
          colocarlos en la raÃ­z del proyecto, con una estructura como esta:
        </p>
        <pre><code class="language-bash">
mi-proyecto/
â”œâ”€â”€ src/                      # Componentes Stencil
â”œâ”€â”€ dist/                    # Output compilado de Stencil
â”œâ”€â”€ stories/                 # Historias de Storybook
â”œâ”€â”€ .storybook/              # ConfiguraciÃ³n de Storybook
â”œâ”€â”€ stencil.config.ts        # ConfiguraciÃ³n de Stencil
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ package.json
  </code></pre>

        <p>Para que Storybook reconozca tus componentes:</p>
        <ol>
          <li>Primero, compila Stencil con <code class="inline-code">npm run build</code>.</li>
          <li>Luego, importa los componentes en <code class="inline-code">preview.js</code> o en cada historia:</li>
        </ol>
        <pre><code class="language-ts">
// .storybook/preview.js o en cada archivo .stories.ts

import { defineCustomElements } from '../dist/loader';
defineCustomElements();
  </code></pre>

        <p>
          Esto asegura que los Web Components generados por Stencil estÃ©n disponibles en las historias de Storybook, sin
          necesidad de copiarlos manualmente.
        </p>

        <h3>ğŸ” Automatizar el proceso</h3>
        <p>Puedes crear un script combinado en <code class="inline-code">package.json</code> para compilar y ejecutar
          Storybook de una vez:</p>
        <pre><code class="language-json">
"scripts": {
  "build": "stencil build",
  "storybook": "storybook dev -p 6006",
  "storybook:start": "npm run build && npm run storybook"
}
  </code></pre>

        <p>AsÃ­ aseguras que Storybook siempre tenga la build de Stencil lista antes de arrancar.</p>

        <h3>ğŸ“ UbicaciÃ³n recomendada de historias</h3>
        <p>Para una mejor organizaciÃ³n, puedes tener tus historias junto a los propios componentes:</p>
        <pre><code class="language-bash">
src/components/mi-boton/
â”œâ”€â”€ mi-boton.tsx
â”œâ”€â”€ mi-boton.css
â”œâ”€â”€ mi-boton.stories.ts   # Historia del componente
  </code></pre>
        <p>Solo asegÃºrate de actualizar <code class="inline-code">main.js</code> de Storybook con la ruta correcta:</p>
        <pre><code class="language-js">
stories: ['../src/components/**/*.stories.ts']
  </code></pre>
      </section>


      <section>
        <h2>âš¡ Consejos para historias mantenibles</h2>
        <ul>
          <li>Utiliza una funciÃ³n <code class="inline-code">Template</code> reutilizable por historia</li>
          <li>Separa historias por componente (uno por archivo)</li>
          <li>Documenta casos de uso comunes</li>
          <li>No pongas lÃ³gica en el HTML: usa props controladas</li>
        </ul>
      </section>

      <section>
        <h2>ğŸš€ Ejecutar Storybook</h2>
        <pre><code class="language-bash">
npm run storybook
        </code></pre>
        <p>Esto abrirÃ¡ Storybook en <code class="inline-code">http://localhost:6006</code>.</p>
      </section>

      <section class="exercise">
        <h3>ğŸ§  Ejercicio prÃ¡ctico</h3>
        <p>
          Configura Storybook para tu librerÃ­a de componentes y crea las siguientes historias:
        </p>
        <ul>
          <li><strong>&lt;mi-boton&gt;</strong> con controles de texto y color</li>
          <li><strong>&lt;tarjeta-user&gt;</strong> que use slots y <code class="inline-code">args</code></li>
          <li>Un decorador que envuelva los componentes en un <code class="inline-code">&lt;div&gt;</code> con padding
          </li>
          <li>Un listener de eventos con <code class="inline-code">@storybook/addon-actions</code></li>
        </ul>
      </section>
    </main>
  </div>

  <footer class="footer">
  <p>&copy; 2025 Curso Avanzado de Stencil.js. Creado por Roberto de la Casa. Todos los derechos reservados.</p>
</footer>
<script src="./js/menu.js"></script>
</body>

</html>